<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Receta - DeliciousRecipes</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../../styles/general.css">
    <link rel="shortcut icon" href="../../assets/logo/cocinero.png" type="image/x-icon">
</head>
<body>
    <nav class="navbar navbar-expand-lg px-4 py-2 fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand contenedor_logo d-flex justify-content-center align-items-center" href="../../index.html">
                <div class="contenedor_logo_imagen">
                    <img src="../../assets/logo/logo.png" alt="Gorra de cocinero" class="imagen">
                </div>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-end " id="navbarNavDropdown">
                <ul class="contenedor_links navbar-nav d-flex align-items-center">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="../../index.html">Inicio</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link" href="#">Recetas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./contacto.html">Contacto</a>
                    </li>
                </ul>
                <button class="btn btn-naranja" id="loginBtn">Iniciar Sesión</button>
                <a class="btn btn-naranja" target="_blank" href="./suscripcion.html" id="suscripcionBtn">Suscribirse</a>
            </div>
            
        </div>
        
    </nav>

    <main class="py-5 my-5">
        <div class="container-fluid contenedor_receta px-5 mt-4">
            <div class="row justify-content-center">
                <div class="col-lg-6 col-md-8 col-sm-10 mb-4">
                    <div class="contenedor_img" id="contenedor_img"></div>
                    <p id="usuario_receta" class="text-center pt-4"></p>
                    <p class="descripcion_receta text-capitalize pt-2 text-center px-5" id="descripcion_receta"></p>
                </div>

                <div class="col-lg-6 col-md-8 col-sm-10 mb-4">
                    <a type="button" class="btn btn_editar_receta" id="editButton">Editar <i class="bi bi-pencil-square"></i></a>
                    <h1 class="titulo_receta text-uppercase fw-bold py-2" id="titulo_receta"></h1>
                    
                    <div class="mb-4">
                        <ul id="contenedor_ingredientes"></ul>
                    </div>
                    

                    <div class="mb-4">
                        <h5 class="subtitulo_instruccion fw-medium fs-4 pt-4">Instrucciones</h5>
                        <p class="instrucciones fw-normal" id="instrucciones_receta"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Inicio de Sesion -->
        <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body p-0">
                        <div class="login-form-overlay d-flex align-items-center justify-content-center">
                            <form class="text-center p-4">
                                <div class="form-group">
                                    <label for="emailModal" class="label_form">Correo electrónico</label>
                                    <input type="email" class="form-control mb-2" id="emailModal" placeholder="Ingrese su correo electrónico">
                                </div>
                                <div class="form-group">
                                    <label for="passwordModal" class="label_form">Contraseña</label>
                                    <input type="password" class="form-control mb-4" id="passwordModal" placeholder="Ingrese su contraseña">
                                </div>
                                <button type="submit" class="btn btn-primary mb-2">Iniciar Sesión</button>
                                <a href="./pages/suscripcion.html" class="btn btn-link">¿No tienes una cuenta? Regístrate</a>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class=" pt-5 footer px-4">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <a class="contenedor_logo d-flex justify-content-center align-items-center" href="../../index.html">
                        <div class="contenedor_logo_imagen">
                            <img src="../../assets/logo/logo.png" alt="Gorra de cocinero" class="imagen">
                        </div>
                    </a>

                    <div class="contenedor_redes d-flex align-items-center justify-content-center flex-wrap p-3 py-4">
                        <i class="bi bi-instagram mx-2 fs-4 icono_ig"></i>
                        <i class="bi bi-facebook mx-2 fs-4 icono_fb"></i>
                        <i class="bi bi-whatsapp mx-2 fs-4 icono_wsp"></i>
                        <i class="bi bi-twitter-x mx-2 fs-4 icono_x"></i>
                    </div>
                </div>
                <div class="col-md-4">
                    <h5 class="text-uppercase">Sobre nosotros</h5>
                    <p>Somos una comunidad que se dedica a compartir las mejores recetas de cocina. Nuestra misión es inspirar y facilitar la preparación de deliciosos platillos en casa.</p>
                </div>
                <div class="col-md-4">
                    <ul class="list-unstyled">
                        <li><a href="#" class="link_footer">Inicio</a></li>
                        <li><a href="#" class="link_footer">Recetas</a></li>
                        <li><a href="#" class="link_footer">Contacto</a></li>
                    </ul>
                </div>

            </div>

            <div class="text-center py-3">
                <small class="">&copy; 2024 Delicius Recipes - Todos los derechos reservados.</small>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="../scripts/script.js"></script>

    <script>
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        
        if (id === null) {
            window.location.href = '/'
        }

        const editButton = document.getElementById("editButton");
        editButton.href = `edit/index.html?id=${id}`;

        function response_received(response) {
            return response.json()
        }

        function parse_data(recipe) {
            const container_img = document.getElementById('contenedor_img');
            const img = document.createElement('img');
            img.src = recipe.imagen_url;
            img.alt = "imagen de receta";
            img.setAttribute("class", "imagen");
            container_img.append(img);

            const title_recipe = document.getElementById('titulo_receta');
            title_recipe.innerText = recipe.nombre;

            const description_recipe = document.getElementById('descripcion_receta');
            description_recipe.innerText = recipe.descripcion;

            const usuario = document.getElementById('usuario_receta');
            usuario.innerText = recipe.usuario;

            const recipe_description = document.getElementById('instrucciones_receta');
            recipe_description.innerText = recipe.instrucciones;

            const container_ingredients = document.getElementById('contenedor_ingredientes');
            container_ingredients.innerHTML = '';


            recipe.ingredientes.forEach(ingredient => {
                const li = document.createElement('li');

                const unit = document.createElement('span');
                unit.setAttribute("class", "fw-bold");
                unit.innerText = `${ingredient.cantidad} ${ingredient.unidad} `;
                li.append(unit);
                li.append(`${ingredient.nombre}`)
                container_ingredients.appendChild(li);
            })

        }
        
        
        function handle_error(error) {
            console.log('ERROR');
            console.log(error);
        }


        fetch(`http://localhost:5000/recetas/${id}`)
            .then(response_received)
            .then(parse_data)
            .catch(handle_error)


    </script>
</body>
</html>